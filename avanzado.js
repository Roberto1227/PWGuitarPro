const acordesNovena = [
    {
      name: "Do9",
      image: "Acordes/Avanzado/9/Do9.png",
      sound: "Acordes/Avanzado/9/Do9.mp3",
      description: "El acorde Do9 incorpora la novena para añadir profundidad y riqueza al sonido, ofreciendo una sensación expansiva.",
      fingerPosition: "Acordes/Avanzado/9/DDo9.png",
    },
    {
      name: "Re9",
      image: "Acordes/Avanzado/9/Re9.png",
      sound: "Acordes/Avanzado/9/Re9.mp3",
      description: "El acorde Re9 brinda una atmósfera llena de matices y profundidad armónica.",
      fingerPosition: "Acordes/Avanzado/9/DRe9.png",
    },
    {
      name: "Mi9",
      image: "Acordes/Avanzado/9/Mi9.png",
      sound: "Acordes/Avanzado/9/Mi9.mp3",
      description: "El acorde Mi9 crea un color tonal único y enriquecedor para cualquier progresión.",
      fingerPosition: "Acordes/Avanzado/9/DMi9.png",
    },
    {
      name: "Fa9",
      image: "Acordes/Avanzado/9/Fa9.png",
      sound: "Acordes/Avanzado/9/La9.mp3",
      description: "El acorde Fa9 proporciona un carácter resonante, ideal para piezas más complejas.",
      fingerPosition: "Acordes/Avanzado/9/DFa9.png",
    },
    {
      name: "Sol9",
      image: "Acordes/Avanzado/9/Sol9.png",
      sound: "Acordes/Avanzado/9/Sol9.mp3",
      description: "El acorde Sol9 añade riqueza armónica con un impacto suave pero resonante.",
      fingerPosition: "Acordes/Avanzado/9/DSol9.png",
    },
    {
      name: "La9",
      image: "Acordes/Avanzado/9/La9.png",
      sound: "Acordes/Avanzado/9/La9.mp3",
      description: "El acorde La9 destaca en estilos de música que buscan profundidad armónica.",
      fingerPosition: "Acordes/Avanzado/9/DLa9.png",
    },
    {
      name: "Si9",
      image: "Acordes/Avanzado/9/Si9.png",
      sound: "Acordes/Avanzado/9/Si9.mp3",
      description: "El acorde Si9 genera un ambiente envolvente y rico en detalles armónicos.",
      fingerPosition: "Acordes/Avanzado/9/DSi9.png",
    },
  ];
  const acordesOnceava = [
    {
      name: "Do11",
      image: "Acordes/Avanzado/11/Do11.png",
      sound: "Acordes/Avanzado/11/Do11.mp3",
      description: "El acorde Do11 incluye la cuarta extendida, dando un carácter etéreo y expansivo a tus composiciones.",
      fingerPosition: "Acordes/Avanzado/11/DDo11.png",
    },
    {
      name: "Re11",
      image: "Acordes/Avanzado/11/Re11.png",
      sound: "Acordes/Avanzado/11/Re11.mp3",
      description: "El acorde Re11 aporta una sensación abierta y soñadora, ideal para melodías tranquilas.",
      fingerPosition: "Acordes/Avanzado/11/DRe11.png",
    },
    {
      name: "Mi11",
      image: "Acordes/Avanzado/11/Mi11.png",
      sound: "Acordes/Avanzado/11/Mi11.mp3",
      description: "El acorde Mi11 evoca un tono suave y armónico, perfecto para pasajes modernos.",
      fingerPosition: "Acordes/Avanzado/11/DMi11.png",
    },
    {
      name: "Fa11",
      image: "Acordes/Avanzado/11/Fa11.png",
      sound: "Acordes/Avanzado/11/Fa11.mp3",
      description: "El acorde Fa11 destaca por su profundidad y su capacidad de enriquecer armonías complejas.",
      fingerPosition: "Acordes/Avanzado/11/DFa11.png",
    },
    {
      name: "Sol11",
      image: "Acordes/Avanzado/11/Sol11.png",
      sound: "Acordes/Avanzado/11/Sol11.mp3",
      description: "El acorde Sol11 genera una atmósfera expansiva y cautivadora en cualquier composición.",
      fingerPosition: "Acordes/Avanzado/11/DSol11.png",
    },
    {
      name: "La11",
      image: "Acordes/Avanzado/11/La11.png",
      sound: "Acordes/Avanzado/11/La11.mp3",
      description: "El acorde La11 aporta profundidad armónica y un carácter distintivo a progresiones.",
      fingerPosition: "Acordes/Avanzado/11/DLa11.png",
    },
    {
      name: "Si11",
      image: "Acordes/Avanzado/11/Si11.png",
      sound: "Acordes/Avanzado/11/Si11.mp3",
      description: "El acorde Si11 produce un efecto etéreo y envolvente, perfecto para estilos experimentales.",
      fingerPosition: "Acordes/Avanzado/11/DSi11.png",
    },
  ];
  const acordesTreceava = [
    {
      name: "Do13",
      image: "Acordes/Avanzado/13/Do13.png",
      sound: "Acordes/Avanzado/13/Do13.mp3",
      description: "El acorde Do13 incluye la treceava, generando un sonido complejo y armónicamente completo.",
      fingerPosition: "Acordes/Avanzado/13/DDo13.png",
    },
    {
      name: "Re13",
      image: "Acordes/Avanzado/13/Re13.png",
      sound: "Acordes/Avanzado/13/Re13.mp3",
      description: "El acorde Re13 aporta riqueza armónica y un carácter envolvente.",
      fingerPosition: "Acordes/Avanzado/13/DRe13.png",
    },
    {
      name: "Mi13",
      image: "Acordes/Avanzado/13/Mi13.png",
      sound: "Acordes/Avanzado/13/Mi13.mp3",
      description: "El acorde Mi13 ofrece una sensación de profundidad y sofisticación armónica.",
      fingerPosition: "Acordes/Avanzado/13/DMi13.png",
    },
    {
      name: "Fa13",
      image: "Acordes/Avanzado/13/Fa13.png",
      sound: "Acordes/Avanzado/13/Fa13.mp3",
      description: "El acorde Fa13 destaca por su carácter rico y melodioso, ideal para estilos complejos.",
      fingerPosition: "Acordes/Avanzado/13/DFa13.png",
    },
    {
      name: "Sol13",
      image: "Acordes/Avanzado/13/Sol13.png",
      sound: "Acordes/Avanzado/13/So13.mp3",
      description: "El acorde Sol13 genera un ambiente cálido y lleno de textura musical.",
      fingerPosition: "Acordes/Avanzado/13/DSol13.png",
    },
    {
      name: "La13",
      image: "Acordes/Avanzado/13/La13.png",
      sound: "Acordes/Avanzado/13/La13.mp3",
      description: "El acorde La13 proporciona un color tonal distintivo que resalta en progresiones avanzadas.",
      fingerPosition: "Acordes/Avanzado/13/DLa13.png",
    },
    {
      name: "Si13",
      image: "Acordes/Avanzado/13/Si13.png",
      sound: "Acordes/Avanzado/13/So13.mp3",
      description: "El acorde Si13 combina profundidad y complejidad, creando un sonido envolvente y armónico.",
      fingerPosition: "Acordes/Avanzado/13/DSi13.png",
    },
  ];
  const acordes7n5 = [
    {
      name: "Do7#5",
      image: "Acordes/Avanzado/7n5/Do75.png",
      sound: "Acordes/Avanzado/7n5/Do75.mp3",
      description: "El acorde Do7#5 combina una triada mayor, séptima menor y quinta aumentada, creando un efecto enigmático y alterado.",
      fingerPosition: "Acordes/Avanzado/7n5/DDo75.png",
    },
    {
      name: "Re7#5",
      image: "Acordes/Avanzado/7n5/Re75.png",
      sound: "Acordes/Avanzado/7n5/Re75.mp3",
      description: "El acorde Re7#5 genera un sonido alterado único y característico de estilos modernos.",
      fingerPosition: "Acordes/Avanzado/7n5/DRe75.png",
    },
    {
      name: "Mi7#5",
      image: "Acordes/Avanzado/7n5/Mi75.png",
      sound: "Acordes/Avanzado/7n5/Mi75.mp3",
      description: "El acorde Mi7#5 ofrece una tonalidad intensa que destaca en progresiones alteradas.",
      fingerPosition: "Acordes/Avanzado/7n5/DMi75.png",
    },
    {
      name: "Fa7#5",
      image: "Acordes/Avanzado/7n5/Fa75.png",
      sound: "Acordes/Avanzado/7n5/Fa75.mp3",
      description: "El acorde Fa7#5 aporta una atmósfera intrigante y distintiva a tus composiciones.",
      fingerPosition: "Acordes/Avanzado/7n5/DFa75.png",
    },
    {
      name: "Sol7#5",
      image: "Acordes/Avanzado/7n5/Sol75.png",
      sound: "Acordes/Avanzado/7n5/Sol75.mp3",
      description: "El acorde Sol7#5 genera una sensación de tensión armónica que cautiva al oyente.",
      fingerPosition: "Acordes/Avanzado/7n5/DSol75.png",
    },
    {
      name: "La7#5",
      image: "Acordes/Avanzado/7n5/La75.png",
      sound: "Acordes/Avanzado/7n5/La75.mp3",
      description: "El acorde La7#5 crea un efecto alterado y dinámico que enriquece cualquier progresión.",
      fingerPosition: "Acordes/Avanzado/7n5/DLa75.png",
    },
    {
      name: "Si7#5",
      image: "Acordes/Avanzado/7n5/Si75.png",
      sound: "Acordes/Avanzado/7n5/S75.mp3",
      description: "El acorde Si7#5 es perfecto para añadir un toque enigmático y poderoso a tus composiciones.",
      fingerPosition: "Acordes/Avanzado/7n5/DSi75.png",
    },
  ];
  const acordes7n9 = [
    {
      name: "Do7#9",
      image: "Acordes/Avanzado/7n9/Do79.png",
      sound: "Acordes/Avanzado/7n9/Do79.mp3",
      description: "El acorde Do7#9 añade una novena aumentada a la triada mayor con séptima menor, generando una rica tensión cromática.",
      fingerPosition: "Acordes/Avanzado/7n9/DDo79.png",
    },
    {
      name: "Re7#9",
      image: "Acordes/Avanzado/7n9/Re79.png",
      sound: "Acordes/Avanzado/7n9/Re79.mp3",
      description: "El acorde Re7#9 introduce una tensión melódica única que añade intensidad a tus progresiones.",
      fingerPosition: "Acordes/Avanzado/7n9/DRe79.png",
    },
    {
      name: "Mi7#9",
      image: "Acordes/Avanzado/7n9/Mi79.png",
      sound: "Acordes/Avanzado/7n9/Mi79.mp3",
      description: "El acorde Mi7#9 ofrece un sonido robusto y cromáticamente intrigante, ideal para estilos jazz y blues.",
      fingerPosition: "Acordes/Avanzado/7n9/DMi79.png",
    },
    {
      name: "Fa7#9",
      image: "Acordes/Avanzado/7n9/Fa79.png",
      sound: "Acordes/Avanzado/7n9/Fa79.mp3",
      description: "El acorde Fa7#9 resalta por su capacidad de crear tensión y liberar energía en progresiones dinámicas.",
      fingerPosition: "Acordes/Avanzado/7n9/DFa79.png",
    },
    {
      name: "Sol7#9",
      image: "Acordes/Avanzado/7n9/Sol79.png",
      sound: "Acordes/Avanzado/7n9/Sol79.mp3",
      description: "El acorde Sol7#9 es ideal para añadir un efecto dramático y emocionalmente cargado en tus composiciones.",
      fingerPosition: "Acordes/Avanzado/7n9/DSol79.png",
    },
    {
      name: "La7#9",
      image: "Acordes/Avanzado/7n9/La79.png",
      sound: "Acordes/Avanzado/7n9/La79.mp3",
      description: "El acorde La7#9 proporciona un sonido distintivo y expresivo, perfecto para pasajes armónicos avanzados.",
      fingerPosition: "Acordes/Avanzado/7n9/DLa79.png",
    },
    {
      name: "Si7#9",
      image: "Acordes/Avanzado/7n9/Si79.png",
      sound: "Acordes/Avanzado/7n9/Si79.mp3",
      description: "El acorde Si7#9 ofrece una rica disonancia que realza cualquier progresión con un carácter cromático distintivo.",
      fingerPosition: "Acordes/Avanzado/7n9/DSi79.png",
    },
  ];
  const acordes69 = [
    {
      name: "Do6/9",
      image: "Acordes/Avanzado/6-9/Do6-9.png",
      sound: "Acordes/Avanzado/6-9/Do6-9.mp3",
      description: "El acorde Do6/9 mezcla la sexta y novena con la triada mayor, aportando suavidad y fluidez a las progresiones.",
      fingerPosition: "Acordes/Avanzado/6-9/DDo6-9.png",
    },
    {
      name: "Re6/9",
      image: "Acordes/Avanzado/6-9/Re6-9.png",
      sound: "Acordes/Avanzado/6-9/Re6-9.mp3",
      description: "El acorde Re6/9 añade un carácter armónico que resalta en melodías suaves y fluidas.",
      fingerPosition: "Acordes/Avanzado/6-9/DRe6-9.png",
    },
    {
      name: "Mi6/9",
      image: "Acordes/Avanzado/6-9/Mi6-9.png",
      sound: "Acordes/Avanzado/6-9/Mi6-9.mp3",
      description: "El acorde Mi6/9 ofrece un sonido cálido y relajante, ideal para pasajes melódicos tranquilos.",
      fingerPosition: "Acordes/Avanzado/6-9/DMi6-9.png",
    },
    {
      name: "Fa6/9",
      image: "Acordes/Avanzado/6-9/Fa6-9.png",
      sound: "Acordes/Avanzado/6-9/Fa6-9.mp3",
      description: "El acorde Fa6/9 crea una atmósfera rica y suave que complementa perfectamente las progresiones armónicas.",
      fingerPosition: "Acordes/Avanzado/6-9/DFa6-9.png",
    },
    {
      name: "Sol6/9",
      image: "Acordes/Avanzado/6-9/Sol6-9.png",
      sound: "Acordes/Avanzado/6-9/Sol6-9.mp3",
      description: "El acorde Sol6/9 aporta fluidez y textura a las composiciones melódicas avanzadas.",
      fingerPosition: "Acordes/Avanzado/6-9/DSol6-9.png",
    },
    {
      name: "La6/9",
      image: "Acordes/Avanzado/6-9/La6-9.png",
      sound: "Acordes/Avanzado/6-9/La6-9.mp3",
      description: "El acorde La6/9 combina suavidad y elegancia, destacando en estilos relajados y armónicos.",
      fingerPosition: "Acordes/Avanzado/6-9/DLa6-9.png",
    },
    {
      name: "Si6/9",
      image: "Acordes/Avanzado/6-9/Si6-9.png",
      sound: "Acordes/Avanzado/6-9/Si6-9.mp3",
      description: "El acorde Si6/9 añade un toque fluido y sofisticado a tus progresiones, perfecto para melodías detalladas.",
      fingerPosition: "Acordes/Avanzado/6-9/DSi6-9.png",
    },
  ];
  const acordes7b5 = [
    {
      name: "Do7b5",
      image: "Acordes/Avanzado/7b5/Do7(b5).png",
      sound: "Acordes/Avanzado/7b5/Do7b5.mp3",
      description: "El acorde Do7b5 incorpora una quinta disminuida junto a la triada mayor y séptima menor, evocando un sonido exótico y disonante.",
      fingerPosition: "Acordes/Avanzado/7b5/DDo7(b5).png",
    },
    {
      name: "Re7b5",
      image: "Acordes/Avanzado/7b5/Re7(b5).png",
      sound: "Acordes/Avanzado/7b5/Re7b5.mp3",
      description: "El acorde Re7b5 añade un toque exótico y profundo, ideal para estilos experimentales.",
      fingerPosition: "Acordes/Avanzado/7b5/DRe7(b5).png",
    },
    {
      name: "Mi7b5",
      image: "Acordes/Avanzado/7b5/Mi7(b5).png",
      sound: "Acordes/Avanzado/7b5/Mi7b5.mp3",
      description: "El acorde Mi7b5 brinda un sonido disonante y fascinante, perfecto para pasajes armónicos complejos.",
      fingerPosition: "Acordes/Avanzado/7b5/DMi7(b5).png",
    },
    {
      name: "Fa7b5",
      image: "Acordes/Avanzado/7b5/Fa7(b5).png",
      sound: "Acordes/Avanzado/7b5/Fa7b5.mp3",
      description: "El acorde Fa7b5 crea una atmósfera rica en disonancia y excentricidad tonal.",
      fingerPosition: "Acordes/Avanzado/7b5/DFa7(b5).png",
    },
    {
      name: "Sol7b5",
      image: "Acordes/Avanzado/7b5/Sol7(b5).png",
      sound: "Acordes/Avanzado/7b5/Sol7b5.mp3",
      description: "El acorde Sol7b5 genera una sensación intrigante y experimental, ideal para composiciones únicas.",
      fingerPosition: "Acordes/Avanzado/7b5/DSol7(b5).png",
    },
    {
      name: "La7b5",
      image: "Acordes/Avanzado/7b5/Mi7(b5).png",
      sound: "Acordes/Avanzado/7b5/Mi7b5.mp3",
      description: "El acorde La7b5 aporta un carácter dramático y evocador que resalta en progresiones armónicas.",
      fingerPosition: "Acordes/Avanzado/7b5/DLa7(b5).png",
    },
    {
      name: "Si7b5",
      image: "Acordes/Avanzado/7b5/Si7(b5).png",
      sound: "Acordes/Avanzado/7b5/Si7b5.mp3",
      description: "El acorde Si7b5 proporciona una tonalidad exótica que enriquece cualquier arreglo melódico.",
      fingerPosition: "Acordes/Avanzado/7b5/DSi7(b5).png",
    },
  ];

// Variables globales
let currentAudio = null;
let currentChordIndex = 0;
let chords = [];

// Obtener elementos del DOM
const lessonModal = document.getElementById('lessonModal');
const introSlide = document.getElementById('introSlide');
const chordSlide = document.getElementById('chordSlide');
const finalSlide = document.getElementById('finalSlide');
const modalClose = document.getElementById('modalClose');

// Array de preguntas sobre las partes de la guitarra
const guitarPartsQuiz = [
    {
        type: "multiple",
        question: "¿Cuál es la parte de la guitarra que se usa para afinar las cuerdas?",
        options: ["Cejilla", "Clavijas", "Puente", "Diapasón"],
        correctAnswer: 1
    },
    {
        type: "truefalse",
        question: "El diapasón es la parte donde se colocan los dedos para tocar las notas.",
        options: ["Verdadero", "Falso"],
        correctAnswer: 0
    },
    {
        type: "multiple",
        question: "¿Qué parte sostiene las cuerdas en la parte inferior de la guitarra?",
        options: ["Cejilla", "Clavijas", "Puente", "Diapasón"],
        correctAnswer: 2
    },
    {
        type: "truefalse",
        question: "Las clavijas se encuentran en la parte superior del mástil de la guitarra.",
        options: ["Verdadero", "Falso"],
        correctAnswer: 0
    },
    {
        type: "multiple",
        question: "¿Cuál es la parte que protege la boca de la guitarra?",
        options: ["Golpeador", "Puente", "Cejilla", "Diapasón"],
        correctAnswer: 0
    },
    {
        type: "truefalse",
        question: "El puente es la parte donde se conectan las cuerdas a la caja de la guitarra.",
        options: ["Verdadero", "Falso"],
        correctAnswer: 0
    },
    {
        type: "multiple",
        question: "¿Qué parte de la guitarra separa los trastes?",
        options: ["Cejilla", "Trastes", "Diapasón", "Puente"],
        correctAnswer: 1
    },
    {
        type: "truefalse",
        question: "La cejilla es una pieza que se coloca en el mástil para cambiar la afinación.",
        options: ["Verdadero", "Falso"],
        correctAnswer: 0
    }
];

// Variables para el quiz
let currentQuestionIndex = 0;
let score = 0;
let totalQuestions = guitarPartsQuiz.length;

// Función para actualizar la visualización del acorde actual
function updateChordDisplay() {
    const currentChord = chords[currentChordIndex];
    document.getElementById('chordName').textContent = currentChord.name;
    document.getElementById('chordImage').src = currentChord.image;
    document.getElementById('chordDescription').textContent = currentChord.description;
    document.getElementById('fingerPosition').src = currentChord.fingerPosition;
}

// Función para mostrar el modal
function showModal(event) {
    if (currentAudio) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
    }

    const lessonType = event.target.getAttribute("data-modal");
    console.log("Botón presionado:", lessonType);

    // Asignar el conjunto de datos correspondiente según el tipo de lección
    if (lessonType === "novena") {
        chords = acordesNovena;
    } else if (lessonType === "onceava") {
        chords = acordesOnceava;
    } else if (lessonType === "treceava") {
        chords = acordesTreceava;
    } else if (lessonType === "7n5") {
        chords = acordes7n5;
    } else if (lessonType === "7n9") {
        chords = acordes7n9;
    } else if (lessonType === "69") {
        chords = acordes69;
    } else if (lessonType === "7b5") {
        chords = acordes7b5;
    } else {
        console.error("Lección no encontrada:", lessonType);
        return;
    }

    // Mostrar el modal
    currentChordIndex = 0;
    lessonModal.classList.remove("hidden");
    introSlide.style.display = "block";
    chordSlide.style.display = "none";
    quizSlide.style.display = "none";
    finalSlide.style.display = "none";

    // Actualizar el nombre y la descripción de la lección
    const lessonNameText =
        lessonType === "novena"
            ? "Lección: Acordes de Novena"
            : lessonType === "onceava"
            ? "Lección: Acordes de Onceava"
            : lessonType === "treceava"
            ? "Lección: Acordes de Treceava"
            : lessonType === "7n5"
            ? "Lección: Acordes de 7#5"
            : lessonType === "7n9"
            ? "Lección: Acordes de 7#9"
            : lessonType === "69"
            ? "Lección: Acordes de 6/9"
            : "Lección: Acordes de 7b5";

    const lessonBriefText =
        lessonType === "novena"
            ? "Descubre cómo los acordes de novena añaden profundidad y riqueza al sonido, ofreciendo una experiencia armónica completa."
            : lessonType === "onceava"
            ? "Explora los acordes de onceava y su carácter etéreo y expansivo, ideales para composiciones modernas."
            : lessonType === "treceava"
            ? "Aprende a usar los acordes de treceava para crear armonías completas y complejas con profundidad tonal."
            : lessonType === "7n5"
            ? "Domina los acordes de 7#5, que combinan triada mayor, séptima menor y quinta aumentada para un sonido alterado y enigmático."
            : lessonType === "7n9"
            ? "Experimenta la tensión cromática que los acordes de 7#9 pueden agregar a tus progresiones musicales."
            : lessonType === "69"
            ? "Explora cómo los acordes de 6/9 mezclan suavidad y fluidez armónica al incorporar la sexta y la novena."
            : "Descubre los acordes de 7b5, con quinta disminuida y séptima menor, que evocan un sonido exótico y disonante.";

    document.getElementById("lessonBrief").textContent = lessonBriefText;
    document.getElementById("lessonName").textContent = lessonNameText;
}

// Función para mostrar el siguiente acorde
function showNextChord() {
    if (currentChordIndex < chords.length - 1) {
        currentChordIndex++;
        updateChordDisplay();
    } else {
        showFinalSlide();
    }
}

// Función para mostrar la slide final
function showFinalSlide() {
    introSlide.style.display = "none";
    chordSlide.style.display = "none";
    quizSlide.style.display = "none";
    finalSlide.style.display = "block";

    // Si es la lección de 7b5, mostrar el botón de finalizar curso
    if (chords === acordes7b5) {
        const finishButton = document.getElementById("finishLesson");
        finishButton.textContent = "Finalizar Curso";
        finishButton.classList.add("finalizar-btn");
    }
}

// Función para generar el PDF del diploma
async function generateDiplomaPDF(studentName) {
    try {
        // Crear el contenido del diploma
        const diplomaContent = `
            <div style="text-align: center; padding: 40px; background: linear-gradient(135deg, #fff9e6 0%, #fff 100%); border: 20px solid #92471f; border-radius: 20px;">
                <img src="imagenes/logo.png" style="width: 120px; margin-bottom: 20px;">
                <h1 style="color: #92471f; font-size: 36px; margin: 20px 0;">Diploma de Finalización</h1>
                <p style="font-size: 18px; margin: 20px 0;">Se otorga el presente diploma a:</p>
                <h2 style="color: #92471f; font-size: 42px; margin: 20px 0; font-family: 'Brush Script MT', cursive;">${studentName}</h2>
                <p style="font-size: 18px; margin: 20px 0;">Por haber completado exitosamente el curso de</p>
                <h3 style="color: #92471f; font-size: 28px; margin: 20px 0;">Acordes Avanzados de Guitarra</h3>
                <p style="font-size: 18px; margin: 20px 0;">Con dedicación y excelencia</p>
                <p style="font-size: 16px; margin-top: 40px;">Fecha: ${new Date().toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                <p style="font-size: 12px; color: #666; margin-top: 20px;">Maestros: Edwin Campos, Roberto Campos, Yader Romero, Diego Avilés</p>
            </div>
        `;

        // Crear un elemento temporal para renderizar el diploma
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = diplomaContent;
        document.body.appendChild(tempDiv);

        // Convertir el diploma a imagen
        const canvas = await html2canvas(tempDiv.firstElementChild, {
            scale: 2,
            backgroundColor: null,
            logging: false
        });

        // Crear el PDF
        const pdf = new jspdf.jsPDF({
            orientation: 'landscape',
            unit: 'mm',
            format: 'a4'
        });

        const imgWidth = 297; // A4 width in mm
        const imgHeight = (canvas.height * imgWidth) / canvas.width;

        pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 0, 0, imgWidth, imgHeight);
        pdf.save(`Diploma_GuitarPro_${studentName}.pdf`);

        // Limpiar el elemento temporal
        document.body.removeChild(tempDiv);

        // Mostrar mensaje de éxito
        alert('¡Felicidades! Tu diploma ha sido generado exitosamente.');
    } catch (error) {
        console.error('Error al generar el diploma:', error);
        alert('Hubo un error al generar el diploma. Por favor, inténtalo de nuevo.');
    }
}

// Función para mostrar el quiz
function showQuiz() {
    const quizContent = `
        <div class="quiz-container">
            <h2>Quiz: Partes de la Guitarra</h2>
            <div class="question-container">
                <p class="question-type">${guitarPartsQuiz[currentQuestionIndex].type === 'truefalse' ? 'Verdadero/Falso' : 'Opción Múltiple'}</p>
                <p class="question">${guitarPartsQuiz[currentQuestionIndex].question}</p>
                <div class="options-container ${guitarPartsQuiz[currentQuestionIndex].type === 'truefalse' ? 'truefalse' : ''}">
                    ${guitarPartsQuiz[currentQuestionIndex].options.map((option, index) => `
                        <button class="option-btn" data-index="${index}">${option}</button>
                    `).join('')}
                </div>
            </div>
            <div class="quiz-progress">
                Pregunta ${currentQuestionIndex + 1} de ${totalQuestions}
            </div>
        </div>
    `;

    // Mostrar el quiz en el modal
    introSlide.style.display = "none";
    chordSlide.style.display = "none";
    finalSlide.style.display = "none";
    
    const quizSlide = document.createElement('div');
    quizSlide.className = 'slide';
    quizSlide.id = 'quizSlide';
    quizSlide.innerHTML = quizContent;
    
    lessonModal.querySelector('.modal-window').appendChild(quizSlide);
    quizSlide.style.display = "block";

    // Agregar event listeners a los botones de opciones
    const optionButtons = quizSlide.querySelectorAll('.option-btn');
    optionButtons.forEach(button => {
        button.addEventListener('click', handleAnswer);
    });
}

// Función para manejar las respuestas
function handleAnswer(event) {
    const selectedAnswer = parseInt(event.target.getAttribute('data-index'));
    const correctAnswer = guitarPartsQuiz[currentQuestionIndex].correctAnswer;

    if (selectedAnswer === correctAnswer) {
        score++;
        event.target.classList.add('correct');
    } else {
        event.target.classList.add('incorrect');
        const correctButton = document.querySelector(`[data-index="${correctAnswer}"]`);
        correctButton.classList.add('correct');
    }

    // Deshabilitar todos los botones después de responder
    const optionButtons = document.querySelectorAll('.option-btn');
    optionButtons.forEach(button => {
        button.disabled = true;
    });

    // Esperar 1 segundo antes de mostrar la siguiente pregunta
    setTimeout(() => {
        currentQuestionIndex++;
        if (currentQuestionIndex < guitarPartsQuiz.length) {
            showQuiz();
        } else {
            showQuizResults();
        }
    }, 1000);
}

// Función para calcular la nota
function calculateGrade() {
    const percentage = (score / totalQuestions) * 100;
    let grade;
    
    if (percentage >= 90) {
        grade = "A";
    } else if (percentage >= 80) {
        grade = "B";
    } else if (percentage >= 70) {
        grade = "C";
    } else if (percentage >= 60) {
        grade = "D";
    } else {
        grade = "F";
    }
    
    return {
        grade,
        percentage,
        score,
        totalQuestions
    };
}

// Función para mostrar los resultados del quiz
function showQuizResults() {
    const results = calculateGrade();
    const quizSlide = document.getElementById('quizSlide');
    const resultsContent = `
        <div class="quiz-results">
            <h2>Resultados del Quiz</h2>
            <div class="grade-display">
                <h3>Calificación: ${results.grade}</h3>
                <p>Puntuación: ${results.score} de ${results.totalQuestions}</p>
                <p>Porcentaje: ${results.percentage.toFixed(1)}%</p>
            </div>
            ${results.grade !== "F" ? `
                <p class="success-message">¡Felicitaciones! Has aprobado el quiz.</p>
                <button id="continueBtn" class="btn-1">Continuar con el Curso</button>
            ` : `
                <p class="error-message">Necesitas estudiar más las partes de la guitarra.</p>
                <button id="retryBtn" class="btn-1">Intentar de nuevo</button>
            `}
        </div>
    `;

    quizSlide.innerHTML = resultsContent;

    // Agregar event listeners a los botones
    const continueBtn = document.getElementById('continueBtn');
    const retryBtn = document.getElementById('retryBtn');

    if (continueBtn) {
        continueBtn.addEventListener('click', () => {
            quizSlide.remove();
            window.location.href = 'avanzado.html';
        });
    }

    if (retryBtn) {
        retryBtn.addEventListener('click', () => {
            currentQuestionIndex = 0;
            score = 0;
            showQuiz();
        });
    }
}

// Agregar event listeners cuando el DOM esté cargado
document.addEventListener('DOMContentLoaded', function() {
    // Event listener para los botones de aprender
    const learnButtons = document.querySelectorAll('.btn-2[data-modal]');
    learnButtons.forEach(button => {
        button.addEventListener('click', showModal);
    });

    // Event listener para el botón de cerrar modal
    if (modalClose) {
        modalClose.addEventListener('click', () => {
            lessonModal.classList.add("hidden");
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
            }
        });
    }

    // Event listener para el botón de iniciar lección
    const startButton = document.getElementById("startLesson");
    if (startButton) {
        startButton.addEventListener('click', () => {
            introSlide.style.display = "none";
            chordSlide.style.display = "block";
            updateChordDisplay();
        });
    }

    // Event listener para el botón de finalizar
    const finishButton = document.getElementById("finishLesson");
    if (finishButton) {
        finishButton.addEventListener('click', () => {
            if (chords === acordes7b5) {
                const userName = prompt('Por favor, ingresa tu nombre para el diploma:');
                if (userName) {
                    generateDiplomaPDF(userName);
                }
            } else {
                lessonModal.classList.add("hidden");
            }
        });
    }

    // Event listener para el botón de sonido
    const playSoundButton = document.getElementById("playSound");
    if (playSoundButton) {
        playSoundButton.addEventListener('click', () => {
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
            }
            const currentChord = chords[currentChordIndex];
            currentAudio = new Audio(currentChord.sound);
            currentAudio.play();
        });
    }

    // Event listeners para navegación entre acordes
    const prevButton = document.getElementById("prevChord");
    const nextButton = document.getElementById("nextChord");

    if (prevButton) {
        prevButton.addEventListener('click', () => {
            if (currentChordIndex > 0) {
                currentChordIndex--;
                updateChordDisplay();
            }
        });
    }

    if (nextButton) {
        nextButton.addEventListener('click', showNextChord);
    }
});



function irASlide(numero) {
  ocultarTodasLasSlides();
  const slide = document.getElementById(`slide${numero}`);
  slide.style.display = "block";

  if (slide.id === "quizSlide") {
    mostrarQuizSlide(); // <- Fuerza recarga del iframe limpio
  }
}

function mostrarQuizSlide() {
  document.querySelectorAll(".slide").forEach(slide => slide.style.display = "none");
  document.getElementById("quizSlide").style.display = "block";

  // ⬇️ Aquí se oculta el botón al abrir
  document.getElementById("finishQuiz").style.display = "none";

  const iframe = document.getElementById("quizFrame");
  iframe.src = "QuizArray.html?nocache=" + Date.now();
}

document.querySelectorAll('.btn-2').forEach(btn => {
  btn.addEventListener('click', () => {
    const leccionStr = btn.getAttribute('data-leccion');
    const leccion = leccionStr ? parseInt(leccionStr) : null;

    if (leccion === null || isNaN(leccion)) {
      console.warn("Botón sin data-leccion válido");
      return;
    }

    const modal = document.getElementById('quizSlide');
    if (modal) modal.style.display = 'block';

    const iframe = document.getElementById('quizFrame');
    if (iframe) {
      iframe.src = `QuizArray.html?leccion=${leccion}`;
    }
  });
});


// Función para cargar el contenido del quiz dinámicamente
function cargarQuizArray() {
  fetch('QuizArray.html')
    .then(response => {
      if (!response.ok) {
        throw new Error('No se pudo cargar el quiz');
      }
      return response.text();
    })
    .then(html => {
      document.getElementById('contenedor-quiz').innerHTML = html;
    })
    .catch(error => {
      console.error('Error al cargar el quiz:', error);
      document.getElementById('contenedor-quiz').innerHTML = '<p>No se pudo cargar el quiz.</p>';
    });
}

  function nextChordHandler() {
  if (currentAudio) {
    currentAudio.pause();
    currentAudio.currentTime = 0;
  }

  if (currentChordIndex < chords.length - 1) {
    currentChordIndex++;
    updateChordSlide();
  } else {
    chordSlide.style.display = "none";
    quizSlide.style.display = "block";  // Mostrar quizSlide aquí
  }
}